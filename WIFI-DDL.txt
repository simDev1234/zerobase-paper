DROP TABLE WIFI;

-- 와이파이
CREATE TABLE WIFI (
	X_SWIFI_MGR_NO TEXT PRIMARY KEY,
	X_SWIFI_WRDOFC TEXT NULL,
	X_SWIFI_MAIN_NM TEXT NULL,
	X_SWIFI_ADRES1	 TEXT NULL,
	X_SWIFI_ADRES2 TEXT NULL,
	X_SWIFI_INSTL_FLOOR TEXT NULL,
	X_SWIFI_INSTL_TY TEXT NULL,
	X_SWIFI_INSTL_MBY TEXT NULL,
	X_SWIFI_SVC_SE TEXT NULL,
	X_SWIFI_CMCWR TEXT NULL,
	X_SWIFI_CNSTC_YEAR TEXT NULL,
	X_SWIFI_INOUT_DOOR	 TEXT NULL,
	X_SWIFI_REMARS3 TEXT NULL,
	LAT REAL,
	LNT REAL,
	WORK_DTTM TEXT
);

-- 와이파이_검색_히스토리
DROP TABLE WIFI_SEARCH_HISTORY;

CREATE TABLE WIFI_SEARCH_HISTORY (
	IDX INTEGER PRIMARY KEY AUTOINCREMENT,
	LAT REAL NOT NULL,
	LNT REAL NOT NULL,
	SEARCH_DTTM TEXT DEFAULT (datetime('now','localtime'))
);


-- 조회
SELECT
round(sin(w.LAT * PI() / 180.0) * sin(0 * PI() / 180.0)
+ cos(w.LAT * PI() / 180.0) * cos(36 * PI() / 180.0)
* cos((w.LAT - 36) * PI() / 180.0), 4) as distance,
w.*
FROM WIFI w
order by distance asc
limit 10 offset 10
;
